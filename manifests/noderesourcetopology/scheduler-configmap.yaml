apiVersion: v1
kind: ConfigMap
metadata:
  name: topo-aware-scheduler-config
  namespace: kube-system
data:
  scheduler-config.yaml: |
      apiVersion: kubescheduler.config.k8s.io/v1
      kind: KubeSchedulerConfiguration
      leaderElection:
        leaderElect: false
      clientConnection:
        kubeconfig: "/etc/kubernetes/scheduler.conf"
      profiles:
        - schedulerName: topo-aware-scheduler
          plugins:
            multiPoint:
              enabled:
              - name: NodeResourceTopologyMatch
                weight: 100
            reserve:
              enabled:
              - name: NodeResourceTopologyMatch
          # optional plugin configs
          pluginConfig:
          - name: NodeResourceTopologyMatch
            args:
              discardReservedNodes: true
              scoringStrategy:
                type: "SocketAlignment"
                resources:
                - name: cpu
                  weight: 1
                - name: memory
                  weight: 1
                - name: nvidia.com/gpu
                  weight: 100